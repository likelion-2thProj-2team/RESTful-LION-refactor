<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>호텔 검색 조회 페이지</title>
    <style>
        body { font-family: Arial, sans-serif; }
        .header { background-color: #f3f3f3; padding: 10px; text-align: center; }
        .search-container { background-color: #fff; padding: 10px; border-bottom: 1px solid #ccc; }
        .main-container { display: flex; justify-content: space-between; margin: 20px; }
        .search-sidebar { border: 1px solid #ccc; padding: 10px; width: 20%; }
        .hotel-list { width: 75%; }
        .hotel-card { border: 1px solid #ccc; margin-bottom: 10px; padding: 10px; display: flex; }
        .hotel-image { width: 30%; }
        .hotel-details { width: 70%; padding-left: 10px; }
        .search-bar { display: flex; justify-content: space-between; flex-wrap: wrap; margin-bottom: 10px; }
        /* 이 아래 부분처럼, overflow를 추가할 수도 있음 */
        /*.search-bar { display: flex; justify-content: space-between; margin-bottom: 10px; overflow: hidden;}*/
        .search-bar input[type="text"], .search-bar input[type="date"] {
            flex-grow: 1;
            flex-shrink: 1;
            /* 이 밑의 부분은 잘 모르겠음 */
            max-width: calc(100% / 4 - 10px);
        }
        input, button { padding: 5px; margin-right: 5px; }
        button { background-color: blue; color: white; border: none; cursor: pointer; }
        .hotel { cursor: pointer}
    </style>
</head>
<body>

<header>
    <th:block th:replace="~{updown/temp-header}"></th:block>
</header>

<aside class="search-container">
    <!--  검색바 여기에 넣기  -->
    <div class="search-bar">
        <input type="text" placeholder="Search Keyword">
        <input type="date">
        <input type="date">
        <button>Search</button>
    </div>
</aside>

<main class="main-container">
    <section class="search-sidebar">
        <!-- 사이드바 관련해서 여기에 넣기 -->
        <label>Filter 1</label>
        <input type="text">
        <label>Filter 2</label>
        <input type="text">
        <button>Search</button>
    </section>

    <!-- 이 부분은 양식이고, 로컬 서버에서 실행했을 때 다음과 같이 나오는것을 확인하기 위해 남겨둠 -->
    <article class="hotel-list">
        <section class="hotel-card">
            <div class="hotel-image">
                Image Placeholder
            </div>
            <div class="hotel-details">
                <h3>Hotel Title</h3>
                <p>Hotel Address</p>
                <p>Description</p>
                <span>Rating</span>
            </div>
        </section>
    </article>
    <!-- 이 부분에서 동적으로 호텔 리스트들을 가져오게 됨, 양식은 위와 비슷함 -->
    <div class="hotel-list" id="hotel-list"></div>

</main>
<th:block th:replace="~{updown/footer}"></th:block>
</body>
<script>
    async function fetchHotels() {
        // 나중에는 checkIn, checkOut, KeyWord 추출해서 api에 보내는 식으로 하면 될듯?
        const checkIn = '2024-05-01';       // 날짜 형식은 'YYYY-MM-DD' 형식임
        const checkOut = '2024-05-05';      // 임의로 2024.05.01 ~ 05.05까지 예약이 없는 호텔들을 조회하겠음
        // 예약 가능한 호텔 조회 부분 (dto 넣어서 보내줘야함)
        const response = await fetch('/api/hotel', {
            method: 'get',
            headers: {
                'Content-Tyoe' : 'application/json',
            },
            body: JSON.stringify({
                keyword: '서울',
                checkIn: checkIn,
                checkOut: checkOut
            })
        })
        if (response.ok) {
            // 정상적으로 불러와졌다면
            const hotels = await response.json();
            console.log(hotels);
            const hotelList = document.getElementById('hotel-list');
            hotels.forEach(hotel => {
                // [1]article 안에 [1-A]section이 담기고
                const hotelInfoDiv = document.createElement('article');
                hotelInfoDiv.classList.add('hotel')

                // 그리고 해당 호텔의 InfoDiv를 누르면, 해당 호텔의 Id로 이동하게 함
                hotelInfoDiv.addEventListener('click', () => {
                    window.location.href = `/hotel/details/${hotel.id}`;
                });

                // [1-A] section 안에 (1)hotel-image(div)와
                const hotelPhoto = document.createElement('img')
                hotelPhoto.src = `${hotel.firstImage}`;
                hotelPhoto.alt = 'hotel_first_image';
                hotelPhoto.classList.add('hotel-photo');

                // [1-B] hotel-details(div) 부분에
                const hotelDetailDiv = document.createElement('div')
                hotelDetailDiv.classList.add('hotel-details');
                // (1) hotel title, (2) hotel Address, (3) hotel description,
                // (4)hotel rating, (5)hotel_tel들이 담길 예정
                const hotelTitleP = document.createElement('p');
                hotelTitleP.innerHTML = `호텔명 : <span>${hotel.title}</span>`
                const hotelAddressP = document.createElement('p');
                hotelAddressP.innerHTML = `주소 : <span>${hotel.address}</span>`
                const hotelDescriptionP = document.createElement('p');
                hotelDescriptionP.innerHTML = `설명 : <span>${hotel.description}</span>`
                const hotelTelP = document.createElement('p')
                hotelTelP.innerHTML = `전화번호 : <span>${hotel.tel}</span>`
                const hotelRatingP = document.createElement('p');
                hotelRatingP.innerHTML = `<span>${hotel.rating}</span>`

                hotelDetailDiv.appendChild(hotelTitleP);
                hotelDetailDiv.appendChild(hotelAddressP);
                hotelDetailDiv.appendChild(hotelDescriptionP);
                hotelDetailDiv.appendChild(hotelRatingP);
                hotelDetailDiv.appendChild(hotelTelP);

                hotelInfoDiv.appendChild(hotelPhoto);
                hotelInfoDiv.appendChild(hotelDetailDiv);
            })
        } else {
            console.error('호텔들 불러오는것에 실패했음', response.statusText);
        }
    }
</script>
</html>
